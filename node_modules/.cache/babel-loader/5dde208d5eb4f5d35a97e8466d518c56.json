{"ast":null,"code":"exports.availableDocumentFeatures = ['FetchExternalResources', 'ProcessExternalResources', 'MutationEvents', 'QuerySelector'];\nexports.defaultDocumentFeatures = {\n  \"FetchExternalResources\": ['script'\n  /*, 'img', 'css', 'frame', 'link'*/\n  ],\n  \"ProcessExternalResources\": ['script'\n  /*, 'frame', 'iframe'*/\n  ],\n  \"MutationEvents\": '2.0',\n  \"QuerySelector\": false\n};\n\nexports.applyDocumentFeatures = function (doc, features) {\n  var i,\n      maxFeatures = exports.availableDocumentFeatures.length,\n      defaultFeatures = exports.defaultDocumentFeatures,\n      j,\n      k,\n      featureName,\n      featureSource;\n  features = features || {};\n\n  for (i = 0; i < maxFeatures; i++) {\n    featureName = exports.availableDocumentFeatures[i];\n\n    if (typeof features[featureName] !== 'undefined') {\n      featureSource = features[featureName]; // We have to check the lowercase version also because the Document feature\n      // methods convert everything to lowercase.\n    } else if (typeof features[featureName.toLowerCase()] !== 'undefined') {\n      featureSource = features[featureName.toLowerCase()];\n    } else if (defaultFeatures[featureName]) {\n      featureSource = defaultFeatures[featureName];\n    } else {\n      continue;\n    }\n\n    doc.implementation.removeFeature(featureName);\n\n    if (typeof featureSource !== 'undefined') {\n      if (featureSource instanceof Array) {\n        k = featureSource.length;\n\n        for (j = 0; j < k; j++) {\n          doc.implementation.addFeature(featureName, featureSource[j]);\n        }\n      } else {\n        doc.implementation.addFeature(featureName, featureSource);\n      }\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"script"}